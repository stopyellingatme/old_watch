function numberWithCommas(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function quarterCountdown(){var e=moment(),t=moment().endOf("quarter").diff(e,"days",!0);document.getElementById("quarterCountdown").innerHTML="<label><strong>"+Number(t).toFixed(1)+"</strong> <small>Days left in Q"+justTheQ+"</small></label>"}function logOut(){firebase.auth().signOut()}function toggleDisplayMode(){$("#modeToggleButton").text("Toggle Investor View"==$("#modeToggleButton").text()?"Toggle Admin View":"Toggle Investor View"),$("#hlthScoreRatioEditButton2").toggle(),$("#hlthScoreRatioEditButton").toggle(),$("#ALLcomponentsEditButton").toggle(),$("#dywChartEditButton").toggle(),$("#aVlChartEditButton").toggle(),$("#sectorDataEditButton").toggle(),$("#compDesEditButton").toggle(),$("#pastHSdataPointButton").toggle(),$("#removePastHSdataButton").toggle(),$("#deleteCompanyButton").toggle(),$("#blankCompanyButton").toggle(),$("#dywChanEditButton").toggle(),$("#aVlDisplayEditButton").toggle(),$("#fadBalanceEditButton").toggle(),$("#fadIncomeEditButton").toggle(),$("#fadCashFlowEditButton").toggle(),$("#allDataInputsCard").toggle()}function linkEmUp(){vex.dialog.open({message:"Add to WatchList. Include dash(-)",input:['<input name="compKey" type="text" min="20" max="20" placeholder="Format: -KjFEpLM12PwlBWbyeCD" required />'].join(""),buttons:[$.extend({},vex.dialog.buttons.YES,{text:"Add Company!"}),$.extend({},vex.dialog.buttons.NO,{text:"Nevermind"})],callback:function(e){if(e){var t=e.compKey;firebase.database().ref().child("users/"+currentUserID+"/linked-companies/"+t).set(!0).then(function(){alert("Successful Company Link!")})}else;}})}function testChart(){var e=document.getElementById("pieChart"),t=document.getElementById("dnChart"),n=document.getElementById("healthScoreBarCharttest"),a=document.getElementById("assetsRadarChart"),o=document.getElementById("ratioWebChart"),i={datasets:[{data:[16,6,13,20,8],backgroundColor:["#FF6384","#4BC0C0","#FFCE56","#E7E9ED","#36A2EB"],label:"Fake Data"}],labels:["Fake Data","Fake Data","Fake Data","Fake Data","Fake Data"]},l={labels:["Fake Data","Fake Data","Fake Data"],datasets:[{data:[300,50,100],backgroundColor:["#FF6384","#36A2EB","#FFCE56"],hoverBackgroundColor:["#FF6384","#36A2EB","#FFCE56"]}]},r={labels:["Fake Data","Fake Data","Fake Data","Fake Data","Fake Data","Fake Data","Fake Data"],datasets:[{label:"Fake Data",backgroundColor:"rgba(179,181,198,0.2)",borderColor:"rgba(179,181,198,1)",pointBackgroundColor:"rgba(179,181,198,1)",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(179,181,198,1)",data:[65,59,90,81,56,55,40]},{label:"Fake Data",backgroundColor:"rgba(255,99,132,0.2)",borderColor:"rgba(255,99,132,1)",pointBackgroundColor:"rgba(255,99,132,1)",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(255,99,132,1)",data:[28,48,40,19,96,27,100]}]};new Chart(e,{type:"pie",data:l,options:{elements:{responsive:!0,arc:{borderColor:"white"}}}}),new Chart(t,{type:"doughnut",data:l,options:{responsive:!0,elements:{arc:{borderColor:"white"}}}}),new Chart(n,{type:"bar",data:{labels:["1-2017","2-2017","3-2017","4-2017","1-2018","2-2018"],datasets:[{label:"Health Score (Fake Data)",data:[8,3.4,4.2,9.3,2.9,10],backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255,99,132,1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{responsive:!0,animation:{easing:"easeInOutElastic"},scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}}),new Chart(a,{data:i,type:"polarArea",options:{deferred:{enabled:!0},elements:{arc:{borderColor:"white"}}}}),new Chart(o,{type:"radar",data:r,options:{responsive:!0,animation:{easing:"easeInOutElastic"},scale:{ticks:{beginAtZero:!0}}}})}function createBlankCompany(){vex.dialog.confirm({message:"Register your Company with WatchTower? This will generate a Key which you can share.",callback:function(e){e?vex.dialog.open({message:"Company Name",input:['<input name="name" type="text"placeholder="Company Name" required />','<input name="mainSector" type="text"placeholder="Main Sector" required />','<input name="subSector" type="text"placeholder="Sub Sector" required />'].join(""),buttons:[$.extend({},vex.dialog.buttons.YES,{text:"Continue"}),$.extend({},vex.dialog.buttons.NO,{text:"Nevermind"})],callback:function(e){if(e){var t=firebase.auth().currentUser.uid,n=firebase.database().ref().child("company-description-data").push().key,a=firebase.database().ref().child("company-description-data/"+n),o=firebase.database().ref().child("formal-accounting-data/"+n+"/"+currentQuarter),i=firebase.database().ref().child("data-you-want/"+n+"/"+currentQuarter),l=firebase.database().ref().child("health-score-data/"+n+"/"+currentQuarter),r=firebase.database().ref().child("sector-data/"+n+"/"+currentQuarter),s=firebase.database().ref().child("users/"+t+"/linked-companies/"+n);a.set({name:"",hq:"",description:"",admin:currentUserID}),a.update({name:e.name,mainSector:e.mainSector,subSector:e.subSector}),o.set({grossOpProfit:0,EBITDA:0,totalAssets:0,totalLiabilities:0,totalEquity:0,EBIT:0,opActivites:0,investActivites:0,financeActivites:0,netInDeInCash:0,property:0,inventory:0,otherAssets:0,acctsPayable:0,accntsReceivable:0,interestPayable:0,taxesPayable:0,otherPayable:0,currentRatio:0,quickRatio:0,interestCoverageRatio:0,timesEarnedRatio:0,debtVsEquityRatio:0,equityMultiplier:0,grossProfitMargin:0,operatingProfitMargin:0,netProfitMargin:0,returnOnAssetsRatio:0,returnOnEquityRatio:0,dsi:0,dso:0,dpo:0,cashCycle:0,inventoryTO:0,receivablesTO:0,payablesTO:0,totalAssetsTO:0}),i.set({acquisitionCostAvg:0,acquisitionRevAvg:0,businessDevExpenditure:0,travelAndEntertainment:0,grossMonthlyExpenditure:0,grossMonthlyRevenue:0,revChannelMain:"",revChannelMainAmt:0,fixedCostMain:"",fixedCostMainAmt:0,dynamicCostMain:"",dynamicCostMainAmt:0}),l.set({TotalExpenses:0,LongTermDebt:0,deltaNetAssets:0,primaryReserveRatio:0,viabilityRatio:0,returnOnNetAssetsRatio:0,netOperatingRevenuesRatio:0,HealthScore:0,cashAndCashEq:0,costOGS:0,sellingAndAdmin:0,depAndAmort:0,otherNonOp:0,incomeTaxExp:0,prevQnetAssets:0,currQnetAssets:0,netIncome:0,netSales:0,interestExp:0}),r.set({item0:"",item1:"",item2:"",item3:"",item4:"",item0Amt:0,item1Amt:0,item2Amt:0,item3Amt:0,item4Amt:0}),s.set(!0).then(function(){$.prompt("This is the new Company's Key: "+n)}).catch(function(e){alert("Error Message: "+e.message),console.log("Remove failed: "+e.message)})}else;}}):console.log("Chicken.")}})}function generateCompanyList(){document.getElementById("companyListNavPannel").innerHTML="";firebase.database().ref("users/"+currentUserID+"/linked-companies").on("child_added",function(e){firebase.database().ref("company-description-data/"+e.key+"/name").once("value").then(function(t){firebase.database().ref("health-score-data/"+e.key+"/"+currentQuarter).once("value").then(function(n){$("#companyListNavPannel").append('<a id="'+e.key+'" class="mdl-navigation__link" style="color: #09293F; font-size: 15px;"  onclick="displayCompanyData(event)"><strong id="'+e.key+'">'+t.val()+"</strong><br>Health: "+Number(n.child("/HealthScore").val()).toFixed(2)+"</a>")})})})}function displayCompanyData(e){companySelectionKey=e.target.id,document.getElementById("finRatioChartArea").innerHTML='<h3 style="color: black;">Select Financial Ratio Below</h3><h5>Display trend data (Line Graph)</h5>',document.getElementById("hsChartArea").innerHTML='<canvas id="healthScoreBarChart" height="35%" width="100%" stlye="display: block;"></canvas>',document.getElementById("ratioWebArea").innerHTML='<canvas id="ratioWebChart" height="100%" width="100%" stlye="display: block;"></canvas>',document.getElementById("assetsRadar").innerHTML='<canvas id="assetsRadarChart" height="320px" width="320px" stlye="display: block;"></canvas>',document.getElementById("pieDiv").innerHTML='<canvas id="pieChart" style="width: 100%; height: 320px;" stlye="display: block;"></canvas>',document.getElementById("doughDiv").innerHTML='<canvas id="dnChart" style="width: 100%; height: 320px;" stlye="display: block;"></canvas>',getHealthScoreData(),getCompanyDescriptionData(),getDataYouWant(),getAccountingData(),firebase.database().ref("sector-data/"+companySelectionKey+"/"+currentQuarter).on("value",function(e){document.getElementById("sectorItem0Row").innerHTML="<td class='mdl-data-table__cell--non-numeric'>"+e.child("/item0").val()+"</td><td>$"+numberWithCommas(e.child("/item0Amt").val())+"</td>",document.getElementById("sectorItem1Row").innerHTML="<td class='mdl-data-table__cell--non-numeric'>"+e.child("/item1").val()+"</td><td>$"+numberWithCommas(e.child("/item1Amt").val())+"</td>",document.getElementById("sectorItem2Row").innerHTML="<td class='mdl-data-table__cell--non-numeric'>"+e.child("/item2").val()+"</td><td>$"+numberWithCommas(e.child("/item2Amt").val())+"</td>",document.getElementById("sectorItem3Row").innerHTML="<td class='mdl-data-table__cell--non-numeric'>"+e.child("/item3").val()+"</td><td>$"+numberWithCommas(e.child("/item3Amt").val())+"</td>",document.getElementById("sectorItem4Row").innerHTML="<td class='mdl-data-table__cell--non-numeric'>"+e.child("/item4").val()+"</td><td>$"+numberWithCommas(e.child("/item4Amt").val())+"</td>"})}function getHealthScoreData(){var e=[],t=[],n=[],a=[],o=$("#ratioWebChart"),i=$("#healthScoreBarChart");firebase.database().ref("health-score-data/"+companySelectionKey).once("value",function(a){a.forEach(function(t){e.push({A:t.key,B:t.child("/HealthScore").val()})}),e.sort(function(e,t){var n=moment(e.A,"Q-YYYY"),a=moment(t.A,"Q-YYYY");return n.diff(a)});var o,i=e.length;for(o=0;o<i;o++)t.push(e[o].A),n.push(e[o].B)}).then(function(){var a=e.length;new Chart(i,{type:"bar",data:{labels:t,datasets:[{label:"Health Scores",data:n,backgroundColor:poolColors(a+1),borderColor:poolColors(a+1),borderWidth:1}]},options:{responsive:!0,scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0,ticks:{min:0,max:10}}]}}})}).catch(function(e){alert("Error Message: "+e.message),console.log("Remove failed: "+e.message)}),firebase.database().ref("health-score-data/"+companySelectionKey+"/"+currentQuarter).on("value",function(e){currCompCash=e.child("/cashAndCashEq").val(),document.getElementById("currentHlthScoreLabel").innerHTML="<h3>Health Score: <strong id='currentHlthScoreLabelNumber'>"+Number(e.child("/HealthScore").val()).toFixed(2)+"</strong></h3>",document.getElementById("cashAndEqRow").innerHTML="$"+numberWithCommas(e.child("/cashAndCashEq").val()),document.getElementById("longtermdebtRow").innerHTML="$"+numberWithCommas(e.child("/LongTermDebt").val()),document.getElementById("netAssetsRow").innerHTML="$"+numberWithCommas(e.child("/currQnetAssets").val()),document.getElementById("prevQnetAssetsRow").innerHTML="$"+numberWithCommas(e.child("/prevQnetAssets").val()),document.getElementById("cogsRow").innerHTML="$"+numberWithCommas(e.child("/costOGS").val()),document.getElementById("sellingAndadminRow").innerHTML="$"+numberWithCommas(e.child("/sellingAndAdmin").val()),document.getElementById("depAndamortRow").innerHTML="$"+numberWithCommas(e.child("/depAndAmort").val()),document.getElementById("interestExpRow").innerHTML="$"+numberWithCommas(e.child("/interestExp").val()),document.getElementById("otherNonOpRow").innerHTML="$"+numberWithCommas(e.child("/otherNonOp").val()),document.getElementById("incomeTaxExpRow").innerHTML="$"+numberWithCommas(e.child("/incomeTaxExp").val()),document.getElementById("netIncomeRow").innerHTML="$"+numberWithCommas(e.child("/netIncome").val()),document.getElementById("netSalesRow").innerHTML="$"+numberWithCommas(e.child("/netSales").val()),document.getElementById("cashAndEqRow2").innerHTML="$"+numberWithCommas(e.child("/cashAndCashEq").val()),document.getElementById("longtermdebtRow2").innerHTML="$"+numberWithCommas(e.child("/LongTermDebt").val()),document.getElementById("netAssetsRow2").innerHTML="$"+numberWithCommas(e.child("/currQnetAssets").val()),document.getElementById("prevQnetAssetsRow2").innerHTML="$"+numberWithCommas(e.child("/prevQnetAssets").val()),document.getElementById("cogsRow2").innerHTML="$"+numberWithCommas(e.child("/costOGS").val()),document.getElementById("sellingAndadminRow2").innerHTML="$"+numberWithCommas(e.child("/sellingAndAdmin").val()),document.getElementById("depAndamortRow2").innerHTML="$"+numberWithCommas(e.child("/depAndAmort").val()),document.getElementById("interestExpRow2").innerHTML="$"+numberWithCommas(e.child("/interestExp").val()),document.getElementById("otherNonOpRow2").innerHTML="$"+numberWithCommas(e.child("/otherNonOp").val()),document.getElementById("incomeTaxExpRow2").innerHTML="$"+numberWithCommas(e.child("/incomeTaxExp").val()),document.getElementById("netSalesRow2").innerHTML="$"+numberWithCommas(e.child("/netSales").val()),document.getElementById("ENA0row").innerHTML="$"+numberWithCommas(e.child("/cashAndCashEq").val()),document.getElementById("totalExpRow").innerHTML="$"+numberWithCommas(e.child("/TotalExpenses").val()),document.getElementById("ENA1row").innerHTML="$"+numberWithCommas(e.child("/cashAndCashEq").val()),document.getElementById("ltdRow").innerHTML="$"+numberWithCommas(e.child("/LongTermDebt").val()),document.getElementById("deltaNetAssetsRow").innerHTML="$"+numberWithCommas(e.child("/deltaNetAssets").val()),document.getElementById("bnaRow").innerHTML="$"+numberWithCommas(e.child("/currQnetAssets").val()),document.getElementById("opSorDrow").innerHTML="$"+numberWithCommas(e.child("/netIncome").val()),document.getElementById("opRevRow").innerHTML="$"+numberWithCommas(e.child("/netSales").val()),document.getElementById("netInRow").innerHTML="$"+numberWithCommas(e.child("/netIncome").val()),document.getElementById("avlCashRow").innerHTML="$"+numberWithCommas(e.child("/cashAndCashEq").val()),document.getElementById("prRatioRow").innerHTML="<strong>"+Number(e.child("/primaryReserveRatio").val()).toFixed(2)+"</strong>",document.getElementById("vrRatioRow").innerHTML="<strong>"+Number(e.child("/viabilityRatio").val()).toFixed(2)+"</strong>",document.getElementById("ronaRatioRow").innerHTML="<strong>"+Number(e.child("/returnOnNetAssetsRatio").val()).toFixed(2)+"</strong>",document.getElementById("oprevRatioRow").innerHTML="<strong>"+Number(e.child("/netOperatingRevenuesRatio").val()).toFixed(2)+"</strong>",Number(e.child("/HealthScore").val()).toFixed(2)>=9?(document.getElementById("currentHlthScoreLabelNumber").style.color="#03b218",document.getElementById("hsMeaningLabel").innerHTML="Strong market position. Strong financial position. Consider expansion and/or acquisitions."):Number(e.child("/HealthScore").val()).toFixed(2)<9&&Number(e.child("/HealthScore").val()).toFixed(2)>=7?document.getElementById("hsMeaningLabel").innerHTML="Strong financial/market position. Allow experimentation with new initiatives.":Number(e.child("/HealthScore").val()).toFixed(2)<7&&Number(e.child("/HealthScore").val()).toFixed(2)>=5?document.getElementById("hsMeaningLabel").innerHTML="Moderate financial/market position. Focus resources to compete in future state.":Number(e.child("/HealthScore").val()).toFixed(2)<5&&Number(e.child("/HealthScore").val()).toFixed(2)>=3?document.getElementById("hsMeaningLabel").innerHTML="Moderate financial/market position. Direct Company resources to allow growth and expansion.":Number(e.child("/HealthScore").val()).toFixed(2)<3&&Number(e.child("/HealthScore").val()).toFixed(2)>=1?document.getElementById("hsMeaningLabel").innerHTML="Weak financial/market position. Assess viability, consider restructuring.":document.getElementById("hsMeaningLabel").innerHTML="Weak financial/market position. Assess viability of survival short term."}),firebase.database().ref("health-score-data/"+companySelectionKey+"/"+currentQuarter).once("value",function(e){var t=Number(e.child("/primaryReserveRatio").val()).toFixed(2),n=Number(e.child("/viabilityRatio").val()).toFixed(2),o=Number(e.child("/returnOnNetAssetsRatio").val()).toFixed(2),i=Number(e.child("/netOperatingRevenuesRatio").val()).toFixed(2);a.push(t,n,o,i)}).then(function(){var e={datasets:[{data:a,backgroundColor:poolColors(5),label:"Core Ratios",pointStyle:"rectRot",pointRadius:5,pointBorderWidth:2,pointBackgroundColor:poolColors(5)}],labels:["Primary Reserve","Viability","Return Net Assets","Net Op Rev"]};new Chart(o,{data:e,type:"radar",options:{responsive:!0,scale:{pointLabels:{fontSize:13}},elements:{arc:{borderColor:"black"}}}})})}function getAccountingData(){var e=[],t=document.getElementById("assetsRadarChart").getContext("2d");firebase.database().ref("formal-accounting-data/"+companySelectionKey+"/"+currentQuarter).on("value",function(e){document.getElementById("totalAssetsRow").innerHTML="$"+numberWithCommas(e.child("/totalAssets").val()),document.getElementById("totalLibRow").innerHTML="$"+numberWithCommas(e.child("/totalLiabilities").val()),document.getElementById("totalEqRow").innerHTML="$"+numberWithCommas(e.child("/totalEquity").val()),document.getElementById("grossOpProfitRow").innerHTML="$"+numberWithCommas(e.child("/grossOpProfit").val()),document.getElementById("EBITDARow").innerHTML="$"+numberWithCommas(e.child("/EBITDA").val()),document.getElementById("OpIncomeRow").innerHTML="$"+numberWithCommas(e.child("/EBIT").val()),document.getElementById("EBITRow").innerHTML="$"+numberWithCommas(e.child("/EBIT").val()),document.getElementById("opActRow").innerHTML="$"+numberWithCommas(e.child("/opActivites").val()),document.getElementById("invActRow").innerHTML="$"+numberWithCommas(e.child("/investActivites").val()),document.getElementById("finActRow").innerHTML="$"+numberWithCommas(e.child("/financeActivites").val()),document.getElementById("netInDeRow").innerHTML="$"+numberWithCommas(e.child("/netInDeInCash").val()),document.getElementById("avlInvRow").innerHTML="$"+numberWithCommas(e.child("/inventory").val()),document.getElementById("avlPropRow").innerHTML="$"+numberWithCommas(e.child("/property").val()),document.getElementById("avlOtherAssetsRow").innerHTML="$"+numberWithCommas(e.child("/otherAssets").val()),document.getElementById("avlAccntsPayRow").innerHTML="$"+numberWithCommas(e.child("/acctsPayable").val()),document.getElementById("avlInterestPayRow").innerHTML="$"+numberWithCommas(e.child("/interestPayable").val()),document.getElementById("avlTaxesPayRow").innerHTML="$"+numberWithCommas(e.child("/taxesPayable").val()),document.getElementById("avlotherPayRow").innerHTML="$"+numberWithCommas(e.child("/otherPayable").val()),document.getElementById("avlInvRow2").innerHTML="$"+numberWithCommas(e.child("/inventory").val()),document.getElementById("avlPropRow2").innerHTML="$"+numberWithCommas(e.child("/property").val()),document.getElementById("avlOtherAssetsRow2").innerHTML="$"+numberWithCommas(e.child("/otherAssets").val()),document.getElementById("avlAccntsPayRow2").innerHTML="$"+numberWithCommas(e.child("/acctsPayable").val()),document.getElementById("avlInterestPayRow2").innerHTML="$"+numberWithCommas(e.child("/interestPayable").val()),document.getElementById("avlTaxesPayRow2").innerHTML="$"+numberWithCommas(e.child("/taxesPayable").val()),document.getElementById("avlotherPayRow2").innerHTML="$"+numberWithCommas(e.child("/otherPayable").val()),document.getElementById("currRatioRow").innerHTML=Number(e.child("/currentRatio").val()).toFixed(2)+"% /avg: 2.5% >",document.getElementById("quickRatioRow").innerHTML=Number(e.child("/quickRatio").val()).toFixed(2)+"% /avg: 1% >",document.getElementById("intCoverRatioRow").innerHTML=Number(e.child("/interestCoverageRatio").val()).toFixed(2)+"% /avg: 2% >",document.getElementById("timesEarnedIntRatioRow").innerHTML=Number(e.child("/timesEarnedRatio").val()).toFixed(2)+"% /avg: 2% >",document.getElementById("debtEqRatioRow").innerHTML=Number(e.child("/debtVsEquityRatio").val()).toFixed(2)+"% /avg: ~0.5-2% ",document.getElementById("eqMultiRatioRow").innerHTML=Number(e.child("/equityMultiplier").val()).toFixed(2)+" /lower better",document.getElementById("grossProfitMarginRow").innerHTML=Number(e.child("/grossProfitMargin").val()).toFixed(2)+"% /avg: 25% >",document.getElementById("opProfitMarginRow").innerHTML=Number(e.child("/operatingProfitMargin").val()).toFixed(2)+"% /avg: 25% >",document.getElementById("netProfitMarginRow").innerHTML=Number(e.child("/netProfitMargin").val()).toFixed(2)+"% /varries",document.getElementById("returnOnAssetsRow").innerHTML=Number(e.child("/returnOnAssetsRatio").val()).toFixed(2)+"% /avg: 5% >",document.getElementById("returnOnEquityRow").innerHTML=Number(e.child("/returnOnEquityRatio").val()).toFixed(2)+"% /avg: 5-15% >",document.getElementById("dsiDisplayRow").innerHTML=Number(e.child("/dsi").val()).toFixed(2)+" /lower better",document.getElementById("dsoDisplayRow").innerHTML=Number(e.child("/dso").val()).toFixed(2)+" /lower better",document.getElementById("dpoDisplayRow").innerHTML=Number(e.child("/dpo").val()).toFixed(2)+" /avg: ~30",document.getElementById("cashCycleDisplayRow").innerHTML=Number(e.child("/cashCycle").val()).toFixed(2)+" /lower better",document.getElementById("invTurnoverRow").innerHTML=Number(e.child("/inventoryTO").val()).toFixed(2)+" /higher better",document.getElementById("recTurnoverRow").innerHTML=Number(e.child("/receivablesTO").val()).toFixed(2)+" /lower better",document.getElementById("payTurnoverRow").innerHTML=Number(e.child("/payablesTO").val()).toFixed(2)+" /extremes bad",document.getElementById("totalTurnoverRow").innerHTML=Number(e.child("/totalAssetsTO").val()).toFixed(2)+" /higher better"}),firebase.database().ref("formal-accounting-data/"+companySelectionKey+"/"+currentQuarter).once("value",function(t){var n=currCompCash,a=t.child("/inventory").val(),o=t.child("/property").val(),i=t.child("/otherAssets").val(),l=t.child("/acctsPayable").val(),r=t.child("/interestPayable").val(),s=t.child("/taxesPayable").val(),d=t.child("/otherPayable").val();e.push(n,a,o,i,l,r,s,d)}).then(function(){var n={datasets:[{data:e,backgroundColor:poolColors(8),label:"My dataset"}],labels:["Cash","Inventory","Property","Other Assets","Accounts Payable","Interest Payable","Taxes Payable","Other Payable"]};new Chart(t,{data:n,type:"polarArea",options:{responsive:!0,elements:{arc:{borderColor:"white"}}}})})}function getDataYouWant(){var e=[],t=[],n=document.getElementById("pieChart"),a=document.getElementById("dnChart");firebase.database().ref("data-you-want/"+companySelectionKey+"/"+currentQuarter).on("value",function(e){document.getElementById("revChannelRow").innerHTML="<td>"+e.child("/revChannelMain").val()+"</td><td>$"+numberWithCommas(e.child("/revChannelMainAmt").val())+"</td><td>Reveue</td>",document.getElementById("dynamicCostRow").innerHTML="<td>"+e.child("/dynamicCostMain").val()+"</td><td>$"+numberWithCommas(e.child("/dynamicCostMainAmt").val())+"</td><td>Dynamic Cost</td>",document.getElementById("fixedCostRow").innerHTML="<td>"+e.child("/fixedCostMain").val()+"</td><td>$"+numberWithCommas(e.child("/fixedCostMainAmt").val())+"</td><td>Fixed Cost</td>",document.getElementById("dywChartReadOut1").innerHTML="<h5 style='color: black;'>Acquisition Reveue: $"+numberWithCommas(e.child("/acquisitionRevAvg").val())+"</h5><h5 style='color: black;'>Acquisition Cost: $"+numberWithCommas(e.child("/acquisitionCostAvg").val())+"</h5>",document.getElementById("dywChartReadOut2").innerHTML="<h5 style='color: black;'> Business Development Expense: $"+numberWithCommas(e.child("/businessDevExpenditure").val())+"</h5><h5 style='color: black;'>Travel and Entertainment: $"+numberWithCommas(e.child("/travelAndEntertainment").val())+"</h5>"}),firebase.database().ref("data-you-want/"+companySelectionKey+"/"+currentQuarter).once("value",function(n){var a=n.child("/acquisitionRevAvg").val(),o=n.child("/acquisitionCostAvg").val(),i=n.child("/businessDevExpenditure").val(),l=n.child("/travelAndEntertainment").val();e.push(a,o),t.push(i,l)}).then(function(){var o={labels:["Acquisition Revenue","Acquisition Cost"],datasets:[{data:e,backgroundColor:["#5edb5e","#e84545"],hoverBackgroundColor:["#5edb5e","#e84545"]}]},i={labels:["Business Development Cost","Travel and Entertainment"],datasets:[{data:t,backgroundColor:["#5edb5e","#e84545"],hoverBackgroundColor:["#5edb5e","#e84545"]}]};new Chart(n,{type:"doughnut",data:o,options:{responsive:!0,elements:{arc:{borderColor:"white"}}}}),new Chart(a,{type:"pie",data:i,options:{responsive:!0,elements:{arc:{borderColor:"white"}}}})})}function getCompanyDescriptionData(){firebase.database().ref("company-description-data/"+companySelectionKey).on("value",function(e){selectedCompanyName=e.child("/name").val(),document.getElementById("compNameLabelHeader").innerHTML=e.child("/name").val(),document.getElementById("compDescripCardNameLabel").innerHTML="<strong>"+e.child("/name").val()+"</strong>",document.getElementById("mainSectorLabel").innerHTML="<h5>"+e.child("/mainSector").val()+"  ---</h5>",document.getElementById("subSectorLabel").innerHTML="<h5>--   "+e.child("/subSector").val()+"</h5>",document.getElementById("hqLabel").innerHTML=e.child("/hq").val(),document.getElementById("companyDescriptionLabel").innerHTML=e.child("/description").val(),document.getElementById("companyKeyLabel").innerHTML="<strong>Company Key: </strong> "+companySelectionKey,document.getElementById("companyNameLabel").innerHTML="<h3><strong>"+e.child("/name").val()+"</strong></h3>",document.getElementById("deleteCompanyButton").innerHTML="<i style='vertical-align: middle;'' class='material-icons'>delete_forever</i> Delete <strong>"+e.child("/name").val()+"</strong> from Database",document.getElementById("removeFromWatchListButton").innerHTML="<i style='vertical-align: middle;'' class='material-icons'>remove_from_queue</i> Remove <strong>"+e.child("/name").val()+"</strong> from WatchList",$("#compSectorLabel").text(e.child("/mainSector").val()+" ----- "+e.child("/subSector").val()),currentUserID==e.child("/admin").val()?($("#allDataInputsCard").show(),document.getElementById("hlthScoreRatioEditButton").style.display="block",document.getElementById("dywChanEditButton").style.display="block",document.getElementById("dywChartEditButton").style.display="block",document.getElementById("aVlChartEditButton").style.display="block",document.getElementById("sectorDataEditButton").style.display="block",document.getElementById("compDesEditButton").style.display="block",document.getElementById("blankCompanyButton").style.display="block",document.getElementById("pastHSdataPointButton").style.display="block",document.getElementById("tutorialButton").style.display="none",document.getElementById("ALLcomponentsEditButton").style.display="block",document.getElementById("removeFromWatchListButton").style.display="block",document.getElementById("removePastHSdataButton").style.display="block",document.getElementById("deleteCompanyButton").style.display="block",document.getElementById("hlthScoreRatioEditButton2").style.display="block",document.getElementById("aVlDisplayEditButton").style.display="block",$("#modeToggleButton").show(),$("#fadBalanceEditButton").show(),$("#fadIncomeEditButton").show(),$("#fadCashFlowEditButton").show(),calculateFinRatios()):($("#allDataInputsCard").hide(),document.getElementById("modeToggleButton").style.display="none",document.getElementById("hlthScoreRatioEditButton").style.display="none",document.getElementById("dywChanEditButton").style.display="none",document.getElementById("dywChartEditButton").style.display="none",document.getElementById("aVlChartEditButton").style.display="none",document.getElementById("sectorDataEditButton").style.display="none",document.getElementById("compDesEditButton").style.display="none",document.getElementById("tutorialButton").style.display="none",document.getElementById("pastHSdataPointButton").style.display="none",document.getElementById("removeFromWatchListButton").style.display="block",document.getElementById("removePastHSdataButton").style.display="none",document.getElementById("deleteCompanyButton").style.display="none",document.getElementById("hlthScoreRatioEditButton2").style.display="none",document.getElementById("ALLcomponentsEditButton").style.display="none",document.getElementById("aVlDisplayEditButton").style.display="none",document.getElementById("fadBalanceEditButton").style.display="none",document.getElementById("fadIncomeEditButton").style.display="none",document.getElementById("fadCashFlowEditButton").style.display="none")}),firebase.storage().ref("/company-description-data/"+companySelectionKey+"/logo").getDownloadURL().then(function(e){var t=e;document.getElementById("logoDisplayImg").src=t}).catch(function(e){document.getElementById("logoDisplayImg").src="img/noImage.png"})}function getFinRatioChartData(e){document.getElementById("finRatioChartArea").innerHTML='<canvas id="finRatioLineChart" height="25%" width="100%" stlye="display: block;"></canvas>';var t=document.getElementById(e.target.id),n=[],a=[],o=[],i=document.getElementById("finRatioLineChart"),l=$(t).attr("value");firebase.database().ref("formal-accounting-data/"+companySelectionKey).once("value",function(e){e.forEach(function(e){n.push({A:e.key,B:e.child("/"+l).val()})}),n.sort(function(e,t){var n=moment(e.A,"Q-YYYY"),a=moment(t.A,"Q-YYYY");return n.diff(a)});var t,i=n.length;for(t=0;t<i;t++)a.push(n[t].A),o.push(n[t].B)}).then(function(){var e=n.length;new Chart(i,{type:"line",data:{labels:a,datasets:[{label:$(t).html(),data:o,backgroundColor:poolColors(e+1),borderColor:poolColors(e+1),borderWidth:2,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:poolColors(e+1),pointBackgroundColor:"#fff",pointBorderWidth:5,pointHoverRadius:5,pointHoverBackgroundColor:poolColors(e+1),pointHoverBorderColor:poolColors(e+1),pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,spanGaps:!1}]},options:{responsive:!0}})}).catch(function(e){alert("Error Message: "+e.message),console.log("Load failed: "+e.message)})}function previousQuarterData(){$.prompt("Now viewing financial data for "+previousQuarter+". Reselect company to view current data."),document.getElementById("finRatioChartArea").innerHTML='<h3 style="color: black;">Select Financial Ratio Below</h3><h5>Display trend data (Line Graph)</h5>',document.getElementById("hsChartArea").innerHTML='<canvas id="healthScoreBarChart" height="35%" width="100%" stlye="display: block;"></canvas>',document.getElementById("ratioWebArea").innerHTML='<canvas id="ratioWebChart" height="100%" width="100%" stlye="display: block;"></canvas>',document.getElementById("assetsRadar").innerHTML='<canvas id="assetsRadarChart" height="320px" width="320px" stlye="display: block;"></canvas>',document.getElementById("pieDiv").innerHTML='<canvas id="pieChart" style="width: 100%; height: 320px;" stlye="display: block;"></canvas>',document.getElementById("doughDiv").innerHTML='<canvas id="dnChart" style="width: 100%; height: 320px;" stlye="display: block;"></canvas>',PREVgetAccountingData(),PREVgetDataYouWant(),PREVgetHealthScoreData(),document.getElementById("hlthScoreRatioEditButton").style.display="none",document.getElementById("dywChanEditButton").style.display="none",document.getElementById("dywChartEditButton").style.display="none",document.getElementById("aVlChartEditButton").style.display="none",document.getElementById("sectorDataEditButton").style.display="none",document.getElementById("compDesEditButton").style.display="none",document.getElementById("tutorialButton").style.display="none",document.getElementById("pastHSdataPointButton").style.display="none",document.getElementById("removeFromWatchListButton").style.display="block",document.getElementById("removePastHSdataButton").style.display="none",document.getElementById("deleteCompanyButton").style.display="none",document.getElementById("hlthScoreRatioEditButton2").style.display="none",document.getElementById("ALLcomponentsEditButton").style.display="none",document.getElementById("fadBalanceEditButton").style.display="none",document.getElementById("fadIncomeEditButton").style.display="none",document.getElementById("fadCashFlowEditButton").style.display="none",document.getElementById("aVlDisplayEditButton").style.display="none",$("#allDataInputsCard").hide(),firebase.database().ref("sector-data/"+companySelectionKey+"/"+previousQuarter).on("value",function(e){document.getElementById("sectorItem0Row").innerHTML="<td class='mdl-data-table__cell--non-numeric'>"+e.child("/item0").val()+"</td><td>$"+numberWithCommas(e.child("/item0Amt").val())+"</td>",document.getElementById("sectorItem1Row").innerHTML="<td class='mdl-data-table__cell--non-numeric'>"+e.child("/item1").val()+"</td><td>$"+numberWithCommas(e.child("/item1Amt").val())+"</td>",document.getElementById("sectorItem2Row").innerHTML="<td class='mdl-data-table__cell--non-numeric'>"+e.child("/item2").val()+"</td><td>$"+numberWithCommas(e.child("/item2Amt").val())+"</td>",document.getElementById("sectorItem3Row").innerHTML="<td class='mdl-data-table__cell--non-numeric'>"+e.child("/item3").val()+"</td><td>$"+numberWithCommas(e.child("/item3Amt").val())+"</td>",document.getElementById("sectorItem4Row").innerHTML="<td class='mdl-data-table__cell--non-numeric'>"+e.child("/item4").val()+"</td><td>$"+numberWithCommas(e.child("/item4Amt").val())+"</td>"})}function PREVgetHealthScoreData(){var e=[],t=[],n=[],a=[],o=document.getElementById("ratioWebChart"),i=document.getElementById("healthScoreBarChart");firebase.database().ref("health-score-data/"+companySelectionKey).once("value",function(a){a.forEach(function(t){e.push({A:t.key,B:t.child("/HealthScore").val()})}),e.sort(function(e,t){var n=moment(e.A,"Q-YYYY"),a=moment(t.A,"Q-YYYY");return n.diff(a)});for(var o=0;o<e.length;o++)t.push(e[o].A),n.push(e[o].B)}).then(function(){new Chart(i,{type:"bar",data:{labels:t,datasets:[{label:"Health Scores",data:n,backgroundColor:poolColors(e.length+1),borderColor:poolColors(e.length+1),borderWidth:1}]},options:{responsive:!0,scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0,ticks:{min:0,max:10}}]}}})}),firebase.database().ref("health-score-data/"+companySelectionKey+"/"+previousQuarter).on("value",function(e){currCompCash=e.child("/cashAndCashEq").val(),document.getElementById("currentHlthScoreLabel").innerHTML="<h3>Health Score: <strong id='currentHlthScoreLabelNumber'>"+Number(e.child("/HealthScore").val()).toFixed(2)+"</strong></h3>",document.getElementById("cashAndEqRow").innerHTML="$"+numberWithCommas(e.child("/cashAndCashEq").val()),document.getElementById("longtermdebtRow").innerHTML="$"+numberWithCommas(e.child("/LongTermDebt").val()),document.getElementById("netAssetsRow").innerHTML="$"+numberWithCommas(e.child("/currQnetAssets").val()),document.getElementById("prevQnetAssetsRow").innerHTML="$"+numberWithCommas(e.child("/prevQnetAssets").val()),document.getElementById("cogsRow").innerHTML="$"+numberWithCommas(e.child("/costOGS").val()),document.getElementById("sellingAndadminRow").innerHTML="$"+numberWithCommas(e.child("/sellingAndAdmin").val()),document.getElementById("depAndamortRow").innerHTML="$"+numberWithCommas(e.child("/depAndAmort").val()),document.getElementById("interestExpRow").innerHTML="$"+numberWithCommas(e.child("/interestExp").val()),document.getElementById("otherNonOpRow").innerHTML="$"+numberWithCommas(e.child("/otherNonOp").val()),document.getElementById("incomeTaxExpRow").innerHTML="$"+numberWithCommas(e.child("/incomeTaxExp").val()),document.getElementById("netIncomeRow").innerHTML="$"+numberWithCommas(e.child("/netIncome").val()),document.getElementById("netSalesRow").innerHTML="$"+numberWithCommas(e.child("/netSales").val()),document.getElementById("cashAndEqRow2").innerHTML="$"+numberWithCommas(e.child("/cashAndCashEq").val()),document.getElementById("longtermdebtRow2").innerHTML="$"+numberWithCommas(e.child("/LongTermDebt").val()),document.getElementById("netAssetsRow2").innerHTML="$"+numberWithCommas(e.child("/currQnetAssets").val()),document.getElementById("prevQnetAssetsRow2").innerHTML="$"+numberWithCommas(e.child("/prevQnetAssets").val()),document.getElementById("cogsRow2").innerHTML="$"+numberWithCommas(e.child("/costOGS").val()),document.getElementById("sellingAndadminRow2").innerHTML="$"+numberWithCommas(e.child("/sellingAndAdmin").val()),document.getElementById("depAndamortRow2").innerHTML="$"+numberWithCommas(e.child("/depAndAmort").val()),document.getElementById("interestExpRow2").innerHTML="$"+numberWithCommas(e.child("/interestExp").val()),document.getElementById("otherNonOpRow2").innerHTML="$"+numberWithCommas(e.child("/otherNonOp").val()),document.getElementById("incomeTaxExpRow2").innerHTML="$"+numberWithCommas(e.child("/incomeTaxExp").val()),document.getElementById("netSalesRow2").innerHTML="$"+numberWithCommas(e.child("/netSales").val()),document.getElementById("ENA0row").innerHTML="$"+numberWithCommas(e.child("/cashAndCashEq").val()),document.getElementById("totalExpRow").innerHTML="$"+numberWithCommas(e.child("/TotalExpenses").val()),document.getElementById("ENA1row").innerHTML="$"+numberWithCommas(e.child("/cashAndCashEq").val()),document.getElementById("ltdRow").innerHTML="$"+numberWithCommas(e.child("/LongTermDebt").val()),document.getElementById("deltaNetAssetsRow").innerHTML="$"+numberWithCommas(e.child("/deltaNetAssets").val()),document.getElementById("bnaRow").innerHTML="$"+numberWithCommas(e.child("/currQnetAssets").val()),document.getElementById("opSorDrow").innerHTML="$"+numberWithCommas(e.child("/netIncome").val()),document.getElementById("opRevRow").innerHTML="$"+numberWithCommas(e.child("/netSales").val()),document.getElementById("netInRow").innerHTML="$"+numberWithCommas(e.child("/netIncome").val()),document.getElementById("avlCashRow").innerHTML="$"+numberWithCommas(e.child("/cashAndCashEq").val()),document.getElementById("prRatioRow").innerHTML="<strong>"+Number(e.child("/primaryReserveRatio").val()).toFixed(2)+"</strong>",document.getElementById("vrRatioRow").innerHTML="<strong>"+Number(e.child("/viabilityRatio").val()).toFixed(2)+"</strong>",document.getElementById("ronaRatioRow").innerHTML="<strong>"+Number(e.child("/returnOnNetAssetsRatio").val()).toFixed(2)+"</strong>",document.getElementById("oprevRatioRow").innerHTML="<strong>"+Number(e.child("/netOperatingRevenuesRatio").val()).toFixed(2)+"</strong>",Number(e.child("/HealthScore").val()).toFixed(2)>=9?(document.getElementById("currentHlthScoreLabelNumber").style.color="#03b218",document.getElementById("hsMeaningLabel").innerHTML="Strong market position. Strong financial position. Consider expansion and/or acquisitions."):Number(e.child("/HealthScore").val()).toFixed(2)<9&&Number(e.child("/HealthScore").val()).toFixed(2)>=7?document.getElementById("hsMeaningLabel").innerHTML="Strong financial/market position. Allow experimentation with new initiatives.":Number(e.child("/HealthScore").val()).toFixed(2)<7&&Number(e.child("/HealthScore").val()).toFixed(2)>=5?document.getElementById("hsMeaningLabel").innerHTML="Moderate financial/market position. Focus resources to compete in future state.":Number(e.child("/HealthScore").val()).toFixed(2)<5&&Number(e.child("/HealthScore").val()).toFixed(2)>=3?document.getElementById("hsMeaningLabel").innerHTML="Moderate financial/market position. Direct Company resources to allow growth and expansion.":Number(e.child("/HealthScore").val()).toFixed(2)<3&&Number(e.child("/HealthScore").val()).toFixed(2)>=1?document.getElementById("hsMeaningLabel").innerHTML="Weak financial/market position. Assess viability, consider restructuring.":document.getElementById("hsMeaningLabel").innerHTML="Weak financial/market position. Assess viability to survive."}),firebase.database().ref("health-score-data/"+companySelectionKey+"/"+previousQuarter).once("value",function(e){var t=Number(e.child("/primaryReserveRatio").val()).toFixed(2),n=Number(e.child("/viabilityRatio").val()).toFixed(2),o=Number(e.child("/returnOnNetAssetsRatio").val()).toFixed(2),i=Number(e.child("/netOperatingRevenuesRatio").val()).toFixed(2);a.push(t,n,o,i)}).then(function(){var e={datasets:[{data:a,backgroundColor:poolColors(a.length+1),label:"Core Ratios",pointStyle:"rectRot",pointRadius:5,pointBorderWidth:10,pointBackgroundColor:poolColors(a.length+1)}],labels:["Primary Reserve","Viability","Return Net Assets","Net Op Rev"]};new Chart(o,{data:e,type:"radar",options:{responsive:!0,scale:{pointLabels:{fontSize:13}},elements:{arc:{borderColor:"black"}}}})})}function PREVgetAccountingData(){var e=[],t=document.getElementById("assetsRadarChart").getContext("2d");firebase.database().ref("formal-accounting-data/"+companySelectionKey+"/"+previousQuarter).on("value",function(e){document.getElementById("totalAssetsRow").innerHTML="$"+numberWithCommas(e.child("/totalAssets").val()),document.getElementById("totalLibRow").innerHTML="$"+numberWithCommas(e.child("/totalLiabilities").val()),document.getElementById("totalEqRow").innerHTML="$"+numberWithCommas(e.child("/totalEquity").val()),document.getElementById("grossOpProfitRow").innerHTML="$"+numberWithCommas(e.child("/grossOpProfit").val()),document.getElementById("EBITDARow").innerHTML="$"+numberWithCommas(e.child("/EBITDA").val()),document.getElementById("OpIncomeRow").innerHTML="$"+numberWithCommas(e.child("/EBIT").val()),document.getElementById("EBITRow").innerHTML="$"+numberWithCommas(e.child("/EBIT").val()),document.getElementById("opActRow").innerHTML="$"+numberWithCommas(e.child("/opActivites").val()),document.getElementById("invActRow").innerHTML="$"+numberWithCommas(e.child("/investActivites").val()),document.getElementById("finActRow").innerHTML="$"+numberWithCommas(e.child("/financeActivites").val()),document.getElementById("netInDeRow").innerHTML="$"+numberWithCommas(e.child("/netInDeInCash").val()),document.getElementById("avlInvRow").innerHTML="$"+numberWithCommas(e.child("/inventory").val()),document.getElementById("avlPropRow").innerHTML="$"+numberWithCommas(e.child("/property").val()),document.getElementById("avlOtherAssetsRow").innerHTML="$"+numberWithCommas(e.child("/otherAssets").val()),document.getElementById("avlAccntsPayRow").innerHTML="$"+numberWithCommas(e.child("/acctsPayable").val()),document.getElementById("avlInterestPayRow").innerHTML="$"+numberWithCommas(e.child("/interestPayable").val()),document.getElementById("avlTaxesPayRow").innerHTML="$"+numberWithCommas(e.child("/taxesPayable").val()),document.getElementById("avlotherPayRow").innerHTML="$"+numberWithCommas(e.child("/otherPayable").val()),document.getElementById("avlInvRow2").innerHTML="$"+numberWithCommas(e.child("/inventory").val()),document.getElementById("avlPropRow2").innerHTML="$"+numberWithCommas(e.child("/property").val()),document.getElementById("avlOtherAssetsRow2").innerHTML="$"+numberWithCommas(e.child("/otherAssets").val()),document.getElementById("avlAccntsPayRow2").innerHTML="$"+numberWithCommas(e.child("/acctsPayable").val()),document.getElementById("avlInterestPayRow2").innerHTML="$"+numberWithCommas(e.child("/interestPayable").val()),document.getElementById("avlTaxesPayRow2").innerHTML="$"+numberWithCommas(e.child("/taxesPayable").val()),document.getElementById("avlotherPayRow2").innerHTML="$"+numberWithCommas(e.child("/otherPayable").val()),document.getElementById("currRatioRow").innerHTML=Number(e.child("/currentRatio").val()).toFixed(2),document.getElementById("quickRatioRow").innerHTML=Number(e.child("/quickRatio").val()).toFixed(2),document.getElementById("intCoverRatioRow").innerHTML=Number(e.child("/interestCoverageRatio").val()).toFixed(2),document.getElementById("timesEarnedIntRatioRow").innerHTML=Number(e.child("/timesEarnedRatio").val()).toFixed(2),document.getElementById("debtEqRatioRow").innerHTML=Number(e.child("/debtVsEquityRatio").val()).toFixed(2),document.getElementById("eqMultiRatioRow").innerHTML=Number(e.child("/equityMultiplier").val()).toFixed(2),document.getElementById("grossProfitMarginRow").innerHTML=Number(e.child("/grossProfitMargin").val()).toFixed(2),document.getElementById("opProfitMarginRow").innerHTML=Number(e.child("/operatingProfitMargin").val()).toFixed(2),document.getElementById("netProfitMarginRow").innerHTML=Number(e.child("/netProfitMargin").val()).toFixed(2),document.getElementById("returnOnAssetsRow").innerHTML=Number(e.child("/returnOnAssetsRatio").val()).toFixed(2),document.getElementById("returnOnEquityRow").innerHTML=Number(e.child("/returnOnEquityRatio").val()).toFixed(2),document.getElementById("dsiDisplayRow").innerHTML=Number(e.child("/dsi").val()).toFixed(2),document.getElementById("dsoDisplayRow").innerHTML=Number(e.child("/dso").val()).toFixed(2),document.getElementById("dpoDisplayRow").innerHTML=Number(e.child("/dpo").val()).toFixed(2),document.getElementById("cashCycleDisplayRow").innerHTML=Number(e.child("/cashCycle").val()).toFixed(2),document.getElementById("invTurnoverRow").innerHTML=Number(e.child("/inventoryTO").val()).toFixed(2),document.getElementById("recTurnoverRow").innerHTML=Number(e.child("/receivablesTO").val()).toFixed(2),document.getElementById("payTurnoverRow").innerHTML=Number(e.child("/payablesTO").val()).toFixed(2),document.getElementById("totalTurnoverRow").innerHTML=Number(e.child("/totalAssetsTO").val()).toFixed(2)}),firebase.database().ref("formal-accounting-data/"+companySelectionKey+"/"+previousQuarter).once("value",function(t){var n=currCompCash,a=t.child("/inventory").val(),o=t.child("/property").val(),i=t.child("/otherAssets").val(),l=t.child("/acctsPayable").val(),r=t.child("/interestPayable").val(),s=t.child("/taxesPayable").val(),d=t.child("/otherPayable").val();e.push(n,a,o,i,l,r,s,d)}).then(function(){var n={datasets:[{data:e,backgroundColor:poolColors(8),label:"My dataset"}],labels:["Cash","Inventory","Property","Other Assets","Accounts Payable","Interest Payable","Taxes Payable","Other Payable"]};new Chart(t,{data:n,type:"polarArea",options:{responsive:!0,elements:{arc:{borderColor:"white"}}}})})}function PREVgetDataYouWant(){var e=[],t=[],n=document.getElementById("pieChart"),a=document.getElementById("dnChart");firebase.database().ref("data-you-want/"+companySelectionKey+"/"+previousQuarter).on("value",function(e){document.getElementById("revChannelRow").innerHTML="<td>"+e.child("/revChannelMain").val()+"</td><td>$"+numberWithCommas(e.child("/revChannelMainAmt").val())+"</td><td>Reveue</td>",document.getElementById("dynamicCostRow").innerHTML="<td>"+e.child("/dynamicCostMain").val()+"</td><td>$"+numberWithCommas(e.child("/dynamicCostMainAmt").val())+"</td><td>Dynamic Cost</td>",document.getElementById("fixedCostRow").innerHTML="<td>"+e.child("/fixedCostMain").val()+"</td><td>$"+numberWithCommas(e.child("/fixedCostMainAmt").val())+"</td><td>Fixed Cost</td>",document.getElementById("dywChartReadOut1").innerHTML="<h5>Acquisition Reveue: $"+numberWithCommas(e.child("/acquisitionRevAvg").val())+"</h5><h5>Acquisition Cost: $"+numberWithCommas(e.child("/acquisitionCostAvg").val())+"</h5>",document.getElementById("dywChartReadOut2").innerHTML="<h5> Business Development Expense: $"+numberWithCommas(e.child("/businessDevExpenditure").val())+"</h5><h5>Travel and Entertainment: $"+numberWithCommas(e.child("/travelAndEntertainment").val())+"</h5>"}),firebase.database().ref("data-you-want/"+companySelectionKey+"/"+previousQuarter).once("value",function(n){var a=n.child("/acquisitionRevAvg").val(),o=n.child("/acquisitionCostAvg").val(),i=n.child("/businessDevExpenditure").val(),l=n.child("/travelAndEntertainment").val();e.push(a,o),t.push(i,l)}).then(function(){var o={labels:["Acquisition Revenue","Acquisition Cost"],datasets:[{data:e,backgroundColor:["#5edb5e","#e84545"],hoverBackgroundColor:["#5edb5e","#e84545"]}]},i={labels:["Business Development Cost","Travel and Entertainment"],datasets:[{data:t,backgroundColor:["#5edb5e","#e84545"],hoverBackgroundColor:["#5edb5e","#e84545"]}]};new Chart(n,{type:"doughnut",data:o,options:{responsive:!0,elements:{arc:{borderColor:"white"}}}}),new Chart(a,{type:"pie",data:i,options:{responsive:!0,elements:{arc:{borderColor:"white"}}}})})}function HSchange(){firebase.database().ref("health-score-data/"+companySelectionKey+"/"+currentQuarter).on("value",function(e){$("#"+companySelectionKey).html('<strong id="'+companySelectionKey+'">'+selectedCompanyName+"</strong><br>Health: "+Number(e.child("/HealthScore").val()).toFixed(2)+"</a>")})}function changeToLineChart(){document.getElementById("hsChartArea").innerHTML='<canvas id="healthScoreLineChart" height="35%" width="100%" stlye="display: block;"></canvas>';var e=[],t=[],n=[],a=document.getElementById("healthScoreLineChart");firebase.database().ref("health-score-data/"+companySelectionKey+"/"+currentQuarter).parent.once("value").then(function(o){o.forEach(function(t){e.push({A:t.key,B:t.child("/HealthScore").val()})}),e.sort(function(e,t){var n=moment(e.A,"Q-YYYY"),a=moment(t.A,"Q-YYYY");return n.diff(a)});var i,l=e.length;for(i=0;i<l;i++)t.push(e[i].A),n.push(e[i].B);new Chart(a,{type:"line",data:{labels:t,datasets:[{label:"All Health Scores",data:n,backgroundColor:poolColors(e.length+1),borderColor:poolColors(e.length+1),borderWidth:2,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:poolColors(e.length+1),pointBackgroundColor:"#fff",pointBorderWidth:5,pointHoverRadius:5,pointHoverBackgroundColor:poolColors(e.length+1),pointHoverBorderColor:poolColors(e.length+1),pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,spanGaps:!1}]},options:{responsive:!0,scales:{yAxes:[{ticks:{min:0,max:10}}]}}})})}function saveDYWmainChanData(){vex.dialog.open({message:"Data You Want (Main Channels)",input:['<input name="revChanTypeInput" type="text" placeholder="Revenue Channel Description"/>','<input name="revChanAmtInput" type="number" placeholder="($.00) Revenue Channel Amount"/>','<input name="fixCostTypeInput" type="text" placeholder="Fixed Cost Description"/>','<input name="fixCostAmtInput" type="number" placeholder="($.00) Fixed Cost Amount"/>','<input name="dynamicCostNameInput" type="text" placeholder="Dynamic Cost Description"/>','<input name="dynamicCostAmtInput" type="number" placeholder="($.00) Dynamic Cost Amount"/>'].join(""),buttons:[$.extend({},vex.dialog.buttons.YES,{text:"Save Data!"}),$.extend({},vex.dialog.buttons.NO,{text:"Nope, nevermind."})],callback:function(e){if(e){var t=firebase.database().ref("data-you-want/"+companySelectionKey+"/"+currentQuarter);null!=e.revChanTypeInput&&t.update({revChannelMain:e.revChanTypeInput}),null!=e.revChanAmtInput&&t.update({revChannelMainAmt:e.revChanAmtInput}),null!=e.fixCostTypeInput&&t.update({fixedCostMain:e.fixCostTypeInput}),null!=e.fixCostAmtInput&&t.update({fixedCostMainAmt:e.fixCostAmtInput}),null!=e.dynamicCostNameInput&&t.update({dynamicCostMain:e.dynamicCostNameInput}),null!=e.dynamicCostAmtInput&&t.update({dynamicCostMainAmt:e.dynamicCostAmtInput})}else;}})}function saveDYWRatiodata(){vex.dialog.open({message:"Data You Want (Chart Data)",input:['<input name="acqCostInput" type="number" placeholder="Acquisition Cost (amount spent to acquire one new customer)"/>','<input name="acqRevInput" type="number" placeholder="Acquisition Revenue (amount made per new customer)"/>','<input name="busDevInput" type="number" placeholder="Business Development Expenditure"/>','<input name="TandEEInput" type="number" placeholder="Travel and Entertainment"/>'].join(""),buttons:[$.extend({},vex.dialog.buttons.YES,{text:"Save Data!"}),$.extend({},vex.dialog.buttons.NO,{text:"Nope, nevermind."})],callback:function(e){if(e){var t=firebase.database().ref("data-you-want/"+companySelectionKey+"/"+currentQuarter);null!=e.acqCostInput&&t.update({acquisitionCostAvg:e.acqCostInput}),null!=e.acqRevInput&&t.update({acquisitionRevAvg:e.acqRevInput}),null!=e.busDevInput&&t.update({businessDevExpenditure:e.busDevInput}),null!=e.TandEEInput&&t.update({travelAndEntertainment:e.TandEEInput}),$.prompt("Success! Refresh Company now.")}else;}})}function saveAssetsAndLibData(){vex.dialog.open({message:"Assets vs. Liabilities",input:['<input name="cashRadarInput" type="number" placeholder="Assets: Cash"/>','<input name="inventoryRadarInput" type="number" placeholder="Assets: Inventory"/>','<input name="propertyRadarInput" type="number" placeholder="Assets: Property"/>','<input name="otherAssetsRadarInput" type="number" placeholder="Assets: Other"/>','<input name="accntsRadarInput" type="number" placeholder="Lib: Accnts Payable"/>','<input name="intRadarInput" type="number" placeholder="Lib: Interest Payable"/>','<input name="taxesRadarInput" type="number" placeholder="Lib: Taxes Payable"/>','<input name="otherLibRadarInput" type="number" placeholder="Lib: Other Payable"/>'].join(""),buttons:[$.extend({},vex.dialog.buttons.YES,{text:"Save Data!"}),$.extend({},vex.dialog.buttons.NO,{text:"Nope, nevermind."})],callback:function(e){if(e){var t=firebase.database().ref("formal-accounting-data/"+companySelectionKey+"/"+currentQuarter);null!=e.cashRadarInput&&firebase.database().ref("health-score-data/"+companySelectionKey+"/"+currentQuarter).update({cashAndCashEq:e.cashRadarInput}),null!=e.inventoryRadarInput&&t.update({inventory:e.inventoryRadarInput}),null!=e.propertyRadarInput&&t.update({property:e.propertyRadarInput}),null!=e.otherAssetsRadarInput&&t.update({otherAssets:e.otherAssetsRadarInput}),null!=e.accntsRadarInput&&t.update({acctsPayable:e.accntsRadarInput}),null!=e.intRadarInput&&t.update({interestPayable:e.intRadarInput}),null!=e.taxesRadarInput&&t.update({taxesPayable:e.taxesRadarInput}),null!=e.otherLibRadarInput&&t.update({otherPayable:e.otherLibRadarInput}),$.prompt("Success! ",{title:"Refresh Company now.",buttons:{"Yes!":!0},submit:function(e,t,n,a){console.log("Value clicked was: "+t),1==t&&(calculateFinRatios(),getCompanyDescriptionData())}})}else;}})}function saveFADBalancedata(){vex.dialog.open({message:"Accounting Data - Balance Sheet (BS)",input:['<input name="totalAssetsInput" type="number" placeholder="(BS) Total Assets"/>','<input name="totalLibInput" type="number" placeholder="(BS) Total Liabilities"/> ','<input name="totalEqInput" type="number" placeholder="(BS) Total Equity"/>','<input name="accntsReceivableInput" type="number" placeholder="(BS) Accounts Receivable"/>','<input name="cashRadarInput" type="number" placeholder="(BS) Assets: Cash"/>','<input name="inventoryRadarInput" type="number" placeholder="(BS) Assets: Inventory"/>','<input name="propertyRadarInput" type="number" placeholder="(BS) Assets: Property"/>','<input name="otherAssetsRadarInput" type="number" placeholder="(BS) Assets: Other"/>','<input name="accntsRadarInput" type="number" placeholder="(BS) Lib: Accnts Payable"/>','<input name="intRadarInput" type="number" placeholder="(BS) Lib: Interest Payable"/>','<input name="taxesRadarInput" type="number" placeholder="(BS) Lib: Taxes Payable"/>','<input name="otherLibRadarInput" type="number" placeholder="(BS) Lib: Other Payable"/>'].join(""),buttons:[$.extend({},vex.dialog.buttons.YES,{text:"Save Data!"}),$.extend({},vex.dialog.buttons.NO,{text:"Nope, nevermind."})],callback:function(e){if(e){var t=firebase.database().ref("formal-accounting-data/"+companySelectionKey+"/"+currentQuarter);null!=e.totalAssetsInput&&t.update({totalAssets:e.totalAssetsInput}),null!=e.totalLibInput&&t.update({totalLiabilities:e.totalLibInput}),null!=e.totalEqInput&&t.update({totalEquity:e.totalEqInput}),null!=e.cashRadarInput&&firebase.database().ref("health-score-data/"+companySelectionKey+"/"+currentQuarter).update({cashAndCashEq:e.cashRadarInput}),null!=e.inventoryRadarInput&&t.update({inventory:e.inventoryRadarInput}),null!=e.propertyRadarInput&&t.update({property:e.propertyRadarInput}),null!=e.otherAssetsRadarInput&&t.update({otherAssets:e.otherAssetsRadarInput}),null!=e.accntsRadarInput&&t.update({acctsPayable:e.accntsRadarInput}),null!=e.intRadarInput&&t.update({interestPayable:e.intRadarInput}),null!=e.taxesRadarInput&&t.update({taxesPayable:e.taxesRadarInput}),null!=e.otherLibRadarInput&&t.update({otherPayable:e.otherLibRadarInput}),null!=e.accntsReceivableInput&&t.update({accntsReceivable:e.accntsReceivableInput}),$.prompt("Success! ",{title:"Refresh Company now.",buttons:{"Yes!":!0},submit:function(e,t,n,a){console.log("Value clicked was: "+t),1==t&&(calculateFinRatios(),getCompanyDescriptionData())}})}else;}})}function saveFADIncomedata(){vex.dialog.open({message:"Income Statement (IS)",input:['<input name="grossOpProfitInput" type="number" placeholder="(IS) Gross Operating Profit"/>','<input name="opIncomeInput" type="number" placeholder="(IS) Operating Income"/>','<input name="netIncomeFADInput" type="number" placeholder="(IS) Net Income"/>','<input name="totalExpensesDialog1" type="number" placeholder="(IS) Cost of Goods Sold"/>','<input name="totalExpensesDialog2" type="number" placeholder="(IS) Selling and General Admin Expense"/>','<input name="totalExpensesDialog3" type="number" placeholder="(IS) Depreciation and Amortization Expense"/>','<input name="totalExpensesDialog4" type="number" placeholder="(IS) Interest Income (Expense)"/>','<input name="totalExpensesDialog5" type="number" placeholder="(IS) Other Non-Operating Income (Expense)"/>','<input name="totalExpensesDialog6" type="number" placeholder="(IS) Income Tax Expense"/>','<input name="opRevDialog" type="number" placeholder="(IS) Net Sales"/>'].join(""),buttons:[$.extend({},vex.dialog.buttons.YES,{text:"Save Data!"}),$.extend({},vex.dialog.buttons.NO,{text:"Nope, nevermind."})],callback:function(e){if(e){var t=firebase.database().ref("formal-accounting-data/"+companySelectionKey+"/"+currentQuarter),n=firebase.database().ref("health-score-data/"+companySelectionKey+"/"+currentQuarter);null!=e.totalExpensesDialog1&&n.update({costOGS:e.totalExpensesDialog1}),null!=e.totalExpensesDialog2&&n.update({sellingAndAdmin:e.totalExpensesDialog2}),null!=e.totalExpensesDialog3&&n.update({depAndAmort:e.totalExpensesDialog3}),null!=e.totalExpensesDialog4&&n.update({interestExp:e.totalExpensesDialog4}),null!=e.totalExpensesDialog5&&n.update({otherNonOp:e.totalExpensesDialog5}),null!=e.totalExpensesDialog6&&n.update({incomeTaxExp:e.totalExpensesDialog6}),null!=e.opRevDialog&&n.update({netSales:e.opRevDialog,opRevenues:e.opRevDialog}),null!=e.grossOpProfitInput&&t.update({grossOpProfit:e.grossOpProfitInput}),null!=e.opIncomeInput&&t.update({EBIT:e.opIncomeInput}),null!=e.netIncomeFADInput&&n.update({netIncome:e.netIncomeFADInput}),$.prompt("Success! ",{title:"Refresh Company now.",buttons:{"Yes!":!0},submit:function(e,t,n,a){1==t&&(calculateFinRatios(),getCompanyDescriptionData())}})}else;}})}function saveFADCashFlowdata(){vex.dialog.open({message:"Cash Flows (CF)",input:['<input name="opActInput" type="number" placeholder="(CF) Operating Activities"/>','<input name="invActInput" type="number" placeholder="(CF) Investing Activities"/>','<input name="finActInput" type="number" placeholder="(CF) Financing Activities"/>','<input name="netInDeInCashInput" type="number" placeholder="(CF) Net Increase/Decrease in Cash"/>'].join(""),buttons:[$.extend({},vex.dialog.buttons.YES,{text:"Save Data!"}),$.extend({},vex.dialog.buttons.NO,{text:"Nope, nevermind."})],callback:function(e){if(e){var t=firebase.database().ref("formal-accounting-data/"+companySelectionKey+"/"+currentQuarter);null!=e.opActInput&&t.update({opActivites:e.opActInput}),null!=e.invActInput&&t.update({investActivites:e.invActInput}),null!=e.finActInput&&t.update({financeActivites:e.finActInput}),null!=e.netInDeInCashInput&&t.update({netInDeInCash:e.netInDeInCashInput}),$.prompt("Success! Refresh Company now.")}else;}})}function saveSectorData(){vex.dialog.open({message:"Sector Data",input:['<input name="sectItem1Input" type="text" placeholder="Description: Item 1"/>','<input name="sectItem1AmtInput" type="number" placeholder="Amount ($.00): Item 1"/> ','<input name="sectItem2Input" type="text" placeholder="Description: Item 2"/>','<input name="sectItem2AmtInput" type="number" placeholder="Amount ($.00): Item 2"/>','<input name="sectItem3Input" type="text" placeholder="Description: Item 3"/>','<input name="sectItem3AmtInput" type="number" placeholder="Amount ($.00): Item 3"/>','<input name="sectItem4Input" type="text" placeholder="Description: Item 4"/>','<input name="sectItem4AmtInput" type="number" placeholder="Amount ($.00): Item 4"/>','<input name="sectItem5Input" type="text" placeholder="Description: Item 5"/>','<input name="sectItem5AmtInput" type="number" placeholder="Amount ($.00): Item 5"/>'].join(""),buttons:[$.extend({},vex.dialog.buttons.YES,{text:"Save Data!"}),$.extend({},vex.dialog.buttons.NO,{text:"Nope, nevermind."})],callback:function(e){if(e){var t=firebase.database().ref().child("sector-data/"+companySelectionKey+"/"+currentQuarter);null!=e.sectItem1Input&&t.update({item0:e.sectItem1Input}),null!=e.sectItem2Input&&t.update({item1:e.sectItem2Input}),null!=e.sectItem3Input&&t.update({item2:e.sectItem3Input}),null!=e.sectItem4Input&&t.update({item3:e.sectItem4Input}),null!=e.sectItem5Input&&t.update({item4:e.sectItem5Input}),null!=e.sectItem1AmtInput&&t.update({item0Amt:e.sectItem1AmtInput}),null!=e.sectItem2AmtInput&&t.update({item1Amt:e.sectItem2AmtInput}),null!=e.sectItem3AmtInput&&t.update({item2Amt:e.sectItem3AmtInput}),null!=e.sectItem4AmtInput&&t.update({item3Amt:e.sectItem4AmtInput}),null!=e.sectItem5AmtInput&&t.update({item4Amt:e.sectItem5AmtInput})}else;}})}function saveCompDescritiondata(){var e={state0:{title:"Company Description Data",html:'<input name="compNameInput" id="name="compNameInput"" type="text" placeholder="Company Name"/><br><input name="mainSectorInput" id="name="mainSectorInput"" type="text" placeholder="Main Sector"/><br><input name="subSectorInput" id="name="subSectorInput"" type="text" placeholder="Sub Sector"/><br><input name="hqInput" id="name="hqInput"" type="text" placeholder="Location"/><br><br><label>Upload Your Logo (256px by 256px - Larger images will be scaled down)</label><br><input type="file" value="upload" name="logoButton" id="logoButton"><br><br><textarea rows="4" cols="20" name="compDescriptionInput" id="name="compDescriptionInput"" type="text" placeholder="Managment to Investor Notes/Dialog"></textarea>',focus:0,buttons:{"Yes, I'm Ready":!0,"No, Nevermind":!1},submit:function(e,t,n,a){if(e.preventDefault(),1==t){var o=firebase.database().ref("/company-description-data/"+companySelectionKey);if(console.log($("#logoButton").val()),""!=a.compNameInput&&o.update({name:a.compNameInput}),""!=a.mainSectorInput&&o.update({mainSector:a.mainSectorInput}),""!=a.subSectorInput&&o.update({subSector:a.subSectorInput}),""!=a.hqInput&&o.update({hq:a.hqInput}),""!=a.compDescriptionInput&&o.update({description:a.compDescriptionInput}),""!=$("#logoButton").val()){var i=document.getElementById("logoButton").files[0];firebase.storage().ref("/company-description-data/"+companySelectionKey+"/logo").put(i).on("state_changed",function(e){},function(e){alert("Error: "+e),console.log(e)},function(){alert("The upload completed!"),$.prompt.close()})}$.prompt.close(),generateCompanyList()}else $.prompt.close()}}};$.prompt(e)}function HScomponentInput(){vex.dialog.open({message:"Taken from Balance Sheet (BS) and Income Statement (IS).",input:['<input name="expNetAssetsDialog" type="number" placeholder="(BS) Cash and Cash Equivalents"/>','<input name="longTermDebtDialog" type="number" placeholder="(BS) Long Term Debt"/>','<input name="beginNetAssetsDialog" type="number" placeholder="(BS) Net Assets (Total Assets - Total Liabilities)"/>','<input name="deltaNetAssetsDialog1" type="number" placeholder="(BS) Previous Q Net Assets"/>','<input name="totalExpensesDialog1" type="number" placeholder="(IS) Cost of Goods Sold"/>','<input name="totalExpensesDialog2" type="number" placeholder="(IS) Selling and General Admin Expense"/>','<input name="totalExpensesDialog3" type="number" placeholder="(IS) Depreciation and Amortization Expense"/>','<input name="totalExpensesDialog4" type="number" placeholder="(IS) Interest Income (Expense)"/>','<input name="totalExpensesDialog5" type="number" placeholder="(IS) Other Non-Operating Income (Expense)"/>','<input name="totalExpensesDialog6" type="number" placeholder="(IS) Income Tax Expense"/>','<input name="opSorDDialog" type="number" placeholder="(IS) Net Income"/>','<input name="opRevDialog" type="number" placeholder="(IS) Net Sales"/>'].join(""),buttons:[$.extend({},vex.dialog.buttons.YES,{text:"Save Data!"}),$.extend({},vex.dialog.buttons.NO,{text:"Nope, nevermind."})],callback:function(e){if(e){var t=firebase.database().ref("health-score-data/"+companySelectionKey+"/"+currentQuarter);null!=e.expNetAssetsDialog&&t.update({cashAndCashEq:e.expNetAssetsDialog}),null!=e.totalExpensesDialog1&&t.update({costOGS:e.totalExpensesDialog1}),null!=e.totalExpensesDialog2&&t.update({sellingAndAdmin:e.totalExpensesDialog2}),null!=e.totalExpensesDialog3&&t.update({depAndAmort:e.totalExpensesDialog3}),null!=e.totalExpensesDialog4&&t.update({interestExp:e.totalExpensesDialog4}),null!=e.totalExpensesDialog5&&t.update({otherNonOp:e.totalExpensesDialog5}),null!=e.totalExpensesDialog6&&t.update({incomeTaxExp:e.totalExpensesDialog6}),null!=e.longTermDebtDialog&&t.update({LongTermDebt:e.longTermDebtDialog}),null!=e.deltaNetAssetsDialog1&&t.update({prevQnetAssets:e.deltaNetAssetsDialog1}),null!=e.beginNetAssetsDialog&&t.update({currQnetAssets:e.beginNetAssetsDialog}),null!=e.opSorDDialog&&t.update({netIncome:e.opSorDDialog}),null!=e.opRevDialog&&t.update({netSales:e.opRevDialog}),$.prompt("Success! ",{title:"Refresh Company now.",buttons:{"Yes!":!0},submit:function(e,t,n,a){console.log("Value clicked was: "+t),1==t&&(calculateFinRatios(),getCompanyDescriptionData())}})}else;}})}function firstPHSDdialog(){vex.dialog.confirm({message:"Make sure all relevant financial data is present before pressing continue.",callback:function(e){e?(console.log("Successfully destroyed the planet."),addPHSDfirstdialog()):console.log("Chicken.")}})}function addPHSDfirstdialog(){vex.dialog.open({message:"FIRST: Enter the QUARTER and YEAR:",input:['<input name="qNum" type="number" min="1" max="4" placeholder="Quarter Number 1-4" required />','<input name="yearNum" type="number" min="1980" max="'+currentYear+'" placeholder="Year e.g. 2008" required />'].join(""),buttons:[$.extend({},vex.dialog.buttons.YES,{text:"Continue"}),$.extend({},vex.dialog.buttons.NO,{text:"Nevermind"})],callback:function(e){if(e){var t=e.qNum+"-"+e.yearNum,n=firebase.database().ref().child("health-score-data/"+companySelectionKey+"/"+t),a=firebase.database().ref().child("formal-accounting-data/"+companySelectionKey+"/"+t),o=firebase.database().ref().child("data-you-want/"+companySelectionKey+"/"+t),i=firebase.database().ref().child("sector-data/"+companySelectionKey+"/"+t);n.set({TotalExpenses:0,LongTermDebt:0,deltaNetAssets:0,primaryReserveRatio:0,viabilityRatio:0,returnOnNetAssetsRatio:0,netOperatingRevenuesRatio:0,HealthScore:0,cashAndCashEq:0,costOGS:0,sellingAndAdmin:0,depAndAmort:0,otherNonOp:0,incomeTaxExp:0,prevQnetAssets:0,currQnetAssets:0,netIncome:0,netSales:0,interestExp:0}),a.set({grossOpProfit:0,EBITDA:0,totalAssets:0,totalLiabilities:0,totalEquity:0,EBIT:0,opActivites:0,investActivites:0,financeActivites:0,netInDeInCash:0,property:0,inventory:0,otherAssets:0,acctsPayable:0,accntsReceivable:0,interestPayable:0,taxesPayable:0,otherPayable:0,currentRatio:0,quickRatio:0,interestCoverageRatio:0,timesEarnedRatio:0,debtVsEquityRatio:0,equityMultiplier:0,grossProfitMargin:0,operatingProfitMargin:0,netProfitMargin:0,returnOnAssetsRatio:0,returnOnEquityRatio:0,dsi:0,dso:0,dpo:0,cashCycle:0,inventoryTO:0,receivablesTO:0,payablesTO:0,totalAssetsTO:0}),o.set({acquisitionCostAvg:0,acquisitionRevAvg:0,businessDevExpenditure:0,travelAndEntertainment:0,grossMonthlyExpenditure:0,grossMonthlyRevenue:0,revChannelMain:"",revChannelMainAmt:0,fixedCostMain:"",fixedCostMainAmt:0,dynamicCostMain:"",dynamicCostMainAmt:0}),i.set({item0:"",item1:"",item2:"",item3:"",item4:"",item0Amt:0,item1Amt:0,item2Amt:0,item3Amt:0,item4Amt:0}),addPHSDseconddialog(t)}else;}})}function addPHSDseconddialog(e){var t=e;vex.dialog.open({message:"Taken from Balance Sheet (BS) and Income Statement (IS). (All fields required for submission. Enter 0 if value is not applicable.)",input:['<input name="expNetAssetsDialog" type="number" placeholder="(BS) Cash and Cash Equivalents" required/>','<input name="longTermDebtDialog" type="number" placeholder="(BS) Long Term Debt" required/>','<input name="beginNetAssetsDialog" type="number" placeholder="(BS) Net Assets (Total Assets - Total Liabilities)" required/>','<input name="deltaNetAssetsDialog1" type="number" placeholder="(BS) Previous Q Net Assets" required/>','<input name="totalExpensesDialog1" type="number" placeholder="(IS) Cost of Goods Sold" required/>','<input name="totalExpensesDialog2" type="number" placeholder="(IS) Selling and General Admin Expense" required/>','<input name="totalExpensesDialog3" type="number" placeholder="(IS) Depreciation and Amortization Expense" required/>','<input name="totalExpensesDialog4" type="number" placeholder="(IS) Interest Income (Expense)" required/>','<input name="totalExpensesDialog5" type="number" placeholder="(IS) Other Non-Operating Income (Expense)" required/>','<input name="totalExpensesDialog6" type="number" placeholder="(IS) Income Tax Expense" required/>','<input name="opSorDDialog" type="number" placeholder="(IS) Net Income" required/>','<input name="opRevDialog" type="number" placeholder="(IS) Net Sales" required/>'].join(""),buttons:[$.extend({},vex.dialog.buttons.YES,{text:"Save Score!"}),$.extend({},vex.dialog.buttons.NO,{text:"Nope, Nevermind"})],callback:function(e){e?firebase.database().ref("/health-score-data/"+companySelectionKey+"/"+t).update({cashAndCashEq:e.expNetAssetsDialog,costOGS:e.totalExpensesDialog1,sellingAndAdmin:e.totalExpensesDialog2,depAndAmort:e.totalExpensesDialog3,interestExp:e.totalExpensesDialog4,otherNonOp:e.totalExpensesDialog5,incomeTaxExp:e.totalExpensesDialog6,LongTermDebt:e.longTermDebtDialog,prevQnetAssets:e.deltaNetAssetsDialog1,currQnetAssets:e.beginNetAssetsDialog,netIncome:e.opSorDDialog,netSales:e.opRevDialog}).then(function(){$.prompt("Success! Refresh Company now.")}).catch(function(e){alert("Error Message: "+e.message),console.log("Remove failed: "+e.message)}):firebase.database().ref("/health-score-data/"+companySelectionKey+"/"+t).remove()}})}function calculateHScomponents(){firebase.database().ref("/users/"+currentUserID+"/linked-companies").orderByKey().on("child_added",function(e){firebase.database().ref("/health-score-data/"+e.key).on("value",function(t){t.forEach(function(t){if(t.child("/costOGS").val()||t.child("/sellingAndAdmin").val()||t.child("/depAndAmort").val()||t.child("/interestExp").val()||t.child("/otherNonOp").val()||null!=t.child("/incomeTaxExp").val()){a=Number(t.child("/costOGS").val())+Number(t.child("/sellingAndAdmin").val())+Number(t.child("/depAndAmort").val())+Number(t.child("/interestExp").val())+Number(t.child("/otherNonOp").val())+Number(t.child("/incomeTaxExp").val());firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({TotalExpenses:a})}if(t.child("/prevQnetAssets").val()||null!=t.child("/currQnetAssets").val()){var n=Number(t.child("/prevQnetAssets").val()),a=Number(t.child("/currQnetAssets").val())-n;firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({deltaNetAssets:a})}})})})}function calculateHealthScore(){firebase.database().ref("/users/"+currentUserID+"/linked-companies").orderByKey().on("child_added",function(e){firebase.database().ref("/health-score-data/"+e.key).on("value",function(t){var n,a,o,i,l;t.forEach(function(t){if(t.child("/cashAndCashEq").val()&&null!=t.child("/TotalExpenses").val())if((n=Number(t.child("/cashAndCashEq").val())/Number(t.child("/TotalExpenses").val()))<3){r=n/.133;firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({primaryReserveRatio:r})}else if(n>=3&&n<10){r=n/.4;firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({primaryReserveRatio:r})}else if(n>=10){r=n/.133;firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({primaryReserveRatio:r})}if(t.child("/cashAndCashEq").val()&&null!=t.child("/LongTermDebt").val())if((a=Number(t.child("/cashAndCashEq").val())/Number(t.child("/LongTermDebt").val()))<3){r=a/.417;firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({viabilityRatio:r})}else if(a>=3&&a<10){r=a/1.25;firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({viabilityRatio:r})}else if(a>=10){r=a/4.16;firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({viabilityRatio:r})}if(t.child("/deltaNetAssets").val()&&null!=t.child("/currQnetAssets").val())if((o=Number(t.child("/deltaNetAssets").val())/Number(t.child("/currQnetAssets").val()))<3){r=o/.02;firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({returnOnNetAssetsRatio:r})}else if(o>=3&&o<10){r=o/.06;firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({returnOnNetAssetsRatio:r})}else if(o>=10){r=o/.2;firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({returnOnNetAssetsRatio:r})}if(t.child("/netIncome").val()&&null!=t.child("/netSales").val())if((i=Number(t.child("/netIncome").val())/Number(t.child("/netSales").val()))<3){r=i/.007;firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({netOperatingRevenuesRatio:r})}else if(i>=3&&i<10){r=i/.02;firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({netOperatingRevenuesRatio:r})}else if(i>=10){var r=i/.067;firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({netOperatingRevenuesRatio:r})}t.child("/primaryReserveRatio").val()&&t.child("/viabilityRatio").val()&&t.child("/returnOnNetAssetsRatio").val()&&null!=t.child("/netOperatingRevenuesRatio").val()&&((l=.35*t.child("/primaryReserveRatio").val()+.35*t.child("/viabilityRatio").val()+.2*t.child("/returnOnNetAssetsRatio").val()+.1*t.child("/netOperatingRevenuesRatio").val())>=10?firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({HealthScore:10}):firebase.database().ref("/health-score-data/"+e.key+"/"+t.key).update({HealthScore:l}))})})})}function fillInTheBlanks(){var e=firebase.database().ref("formal-accounting-data/"+companySelectionKey+"/"+currentQuarter);firebase.database().ref("health-score-data/"+companySelectionKey+"/"+currentQuarter).once("value").then(function(t){if(0!=(t.child("netSales").val()&&t.child("costOGS").val()&&t.child("sellingAndAdmin").val())){var n=t.child("netSales").val()-t.child("costOGS").val()-t.child("sellingAndAdmin").val();e.update({EBITDA:n})}else console.log("EBITA didnt fire.");if(0!=(t.child("netSales").val()&&t.child("costOGS").val()&&t.child("sellingAndAdmin").val()&&t.child("depAndAmort").val())){var a=t.child("netSales").val()-t.child("costOGS").val()-t.child("sellingAndAdmin").val()-t.child("depAndAmort").val();e.update({EBIT:a})}else console.log("EBIT didnt fire.");if(0!=(t.child("netSales").val()&&t.child("costOGS").val()&&t.child("sellingAndAdmin").val())){var o=t.child("netSales").val()-t.child("costOGS").val();e.update({grossOpProfit:o})}else console.log(" Gross Profit didnt fire.")})}function calculateFinRatios(){fillInTheBlanks();var e=firebase.database().ref("formal-accounting-data/"+companySelectionKey+"/"+currentQuarter),t=firebase.database().ref("health-score-data/"+companySelectionKey+"/"+currentQuarter);e.on("value",function(n){t.once("value").then(function(t){if($(document).ready(function(){if(0!=(n.child("inventory").val()&&t.child("costOGS").val())){var a=n.child("inventory").val()/(t.child("costOGS").val()/365);e.update({dsi:a})}else console.log("DSI  didnt fire.");if(0!=(n.child("accntsReceivable").val()&&t.child("netSales").val())){var o=n.child("accntsReceivable").val()/(4*t.child("netSales").val()/365);e.update({dso:o})}else console.log("DSO  didnt fire.");if(0!=(n.child("acctsPayable").val()&&t.child("netSales").val())){var i=n.child("accntsReceivable").val()/(t.child("costOGS").val()/365);e.update({dpo:i})}else console.log("DPO  didnt fire.");if(0!=(n.child("inventory").val()&&t.child("costOGS").val())){var l=t.child("costOGS").val()/n.child("inventory").val();e.update({inventoryTO:l})}else console.log("INVENTORY TURNOVER didnt fire.");if(0!=(t.child("netSales").val()&&n.child("accntsReceivable").val())){var r=t.child("netSales").val()/n.child("accntsReceivable").val();e.update({receivablesTO:r})}else console.log("RECEIVABLES TURNOVER didnt fire.");if(0!=(n.child("acctsPayable").val()&&t.child("costOGS").val())){var s=t.child("costOGS").val()/n.child("acctsPayable").val();e.update({payablesTO:s})}else console.log("INVENTORY TURNOVER didnt fire.");if(0!=(t.child("netSales").val()&&n.child("totalAssets").val())){var d=t.child("netSales").val()/n.child("totalAssets").val();e.update({totalAssetsTO:d})}else console.log("TOTAL ASSETS TURNOVER didnt fire.");if(0!=(n.child("totalAssets").val()&&n.child("totalLiabilities").val())){var c=n.child("totalAssets").val()/n.child("totalLiabilities").val();e.update({currentRatio:c})}else console.log("Current Ratio didnt fire.");if(0!=(n.child("totalAssets").val()&&n.child("inventory").val()&&n.child("totalLiabilities").val())){var m=(n.child("totalAssets").val()-n.child("inventory").val())/n.child("totalLiabilities").val();e.update({quickRatio:m})}else console.log("Quick Ratio didnt fire.");if(0!=(n.child("EBIT").val()&&t.child("interestExp").val())){var u=n.child("EBIT").val()/t.child("interestExp").val();e.update({timesEarnedRatio:u})}else console.log("Times Earned Ratio didnt fire.");if(0!=(n.child("EBITDA").val()&&t.child("interestExp").val())){var h=n.child("EBITDA").val()/t.child("interestExp").val();e.update({interestCoverageRatio:h})}else console.log("Interest Coverage Ratio didnt fire.");if(0!=(n.child("totalLiabilities").val()&&n.child("totalEquity").val())){var p=n.child("totalLiabilities").val()/n.child("totalEquity").val();e.update({debtVsEquityRatio:p})}else console.log("Debt vs. Equity Ratio didnt fire.");if(0!=(n.child("totalAssets").val()&&n.child("totalEquity").val())){var y=n.child("totalAssets").val()/n.child("totalEquity").val();e.update({equityMultiplier:y})}else console.log("Equity Multiplier  didnt fire.");if(0!=(t.child("netSales").val()&&t.child("costOGS").val())){var v=(t.child("netSales").val()-t.child("costOGS").val())/t.child("netSales").val()*100;e.update({grossProfitMargin:v})}else console.log("Gross Profit Margin didnt fire.");if(0!=(n.child("EBIT").val()&&t.child("netSales").val())){var b=n.child("EBIT").val()/t.child("netSales").val()*100;e.update({operatingProfitMargin:b})}else console.log("Operating Profit Margin didnt fire.");if(0!=(t.child("netSales").val()&&t.child("netIncome").val())){var g=t.child("netIncome").val()/t.child("netSales").val()*100;e.update({netProfitMargin:g})}else console.log("Net Profit Margin didnt fire.");if(0!=(n.child("totalAssets").val()&&t.child("netIncome").val())){var f=t.child("netIncome").val()/n.child("totalAssets").val()*100;e.update({returnOnAssetsRatio:f})}else console.log("Retrun on Assets didnt fire.");if(0!=(n.child("totalEquity").val()&&t.child("netIncome").val())){var I=t.child("netIncome").val()/n.child("totalEquity").val()*100;e.update({returnOnEquityRatio:I})}else console.log("Retrun on Equity didnt fire.")}),0!=(n.child("dsi").val()&&n.child("dso").val()&&n.child("dpo").val())){var a=n.child("dsi").val()+n.child("dso").val()-n.child("dpo").val();e.update({cashCycle:a})}else console.log("CASH CYCLE  didnt fire.")})})}function deleteSelectedCompany(){vex.dialog.confirm({message:"WARNING! This will perminetly delete "+selectedCompanyName+" from the database! Are you sure you'd like to delete "+selectedCompanyName+"?",callback:function(e){e?(console.log("Successfully destroyed the planet."),firebase.database().ref("company-description-data/"+companySelectionKey).remove().then(function(){console.log("Remove succeeded.")}).catch(function(e){}),firebase.database().ref("health-score-data/"+companySelectionKey).remove().then(function(){}).catch(function(e){}),firebase.database().ref("formal-accounting-data/"+companySelectionKey).remove().then(function(){}).catch(function(e){}),firebase.database().ref("sector-data/"+companySelectionKey).remove().then(function(){}).catch(function(e){}),firebase.database().ref("data-you-want/"+companySelectionKey).remove().then(function(){}).catch(function(e){}),firebase.database().ref("users/"+currentUserID+"/linked-companies/"+companySelectionKey).remove().then(function(){console.log("Remove succeeded."),$.prompt("It's gone!!!")}).catch(function(e){alert("Error Message: "+e.message),console.log("Remove failed: "+e.message)}),generateCompanyList()):console.log("Woof")}})}function removePastHealthScore(){vex.dialog.open({message:"WARNING! This will perminetely delete data. To continue enter Quarter and Year:",input:['<input name="qNum" type="number" min="1" max="4" placeholder="Quarter Number 1-4" required />','<input name="yearNum" type="number" max="'+currentYear+'" placeholder="Year e.g. 2008" required />'].join(""),buttons:[$.extend({},vex.dialog.buttons.YES,{text:"Delete Data!"}),$.extend({},vex.dialog.buttons.NO,{text:"Nope, Nevermind."})],callback:function(e){if(e){var t=e.qNum+"-"+e.yearNum;firebase.database().ref().child("formal-accounting-data/"+companySelectionKey+"/"+t).remove().then(function(){console.log("FAD Remove succeeded.")}).catch(function(e){console.log("Remove failed: "+e.message)}),dywDataBaseRef=firebase.database().ref().child("data-you-want/"+companySelectionKey+"/"+t).remove().then(function(){console.log("DYW Remove succeeded.")}).catch(function(e){console.log("Remove failed: "+e.message)}),sectDataBaseRef=firebase.database().ref().child("sector-data/"+companySelectionKey+"/"+t).remove().then(function(){console.log("SECTOR Remove succeeded.")}).catch(function(e){console.log("Remove failed: "+e.message)}),firebase.database().ref("health-score-data/"+companySelectionKey+"/"+t).remove().then(function(){$.prompt("Remove Successful! Refresh Company Now."),console.log("Remove succeeded.")}).catch(function(e){alert("Error Message: "+e.message),console.log("Remove failed: "+e.message)})}else console.log("Cancelled")}})}function removeFromWatchList(){vex.dialog.confirm({message:"Are you sure you'd like to remove "+selectedCompanyName+" from your WatchList?",callback:function(e){e?(console.log("Successfully destroyed the planet."),firebase.database().ref("users/"+currentUserID+"/linked-companies/"+companySelectionKey).remove().then(function(){console.log("Remove succeeded."),generateCompanyList()}).catch(function(e){alert("Error Message: "+e.message),console.log("Remove failed: "+e.message)})):console.log("Chicken.")}})}function whatUserTypeAreYou(){var e=[],t=firebase.database().ref("users/"+currentUserID+"/type");firebase.database().ref("users/"+currentUserID+"/linked-companies").once("value",function(t){e.push(t.key)});t.once("value").then(function(t){"Investor"==t.val()?($("#allDataInputsCard").hide(),$("#hlthScoreRatioEditButton").hide(),$("#hlthScoreRatioEditButton2").hide(),$("#dywChanEditButton").hide(),$("#dywChartEditButton").hide(),$("#aVlChartEditButton").hide(),$("#sectorDataEditButton").hide(),$("#compDesEditButton").hide(),$("#blankCompanyButton").hide(),$("#pastHSdataPointButton").hide(),$("#removePastHSdataButton").hide(),$("#deleteCompanyButton").hide(),$("#fadBalanceEditButton").hide(),$("#fadIncomeEditButton").hide(),$("#fadCashFlowEditButton").hide(),setTimeout(function(){investorTour()},500)):"Entrepreneur"==t.val()?(e.length>20&&($("#addCompanyButton").hide(),$("#blankCompanyButton").hide()),setTimeout(function(){accntntTour()},500)):"Accountant"==t.val()&&setTimeout(function(){accntntTour()},500)})}function tourAgain(){firebase.database().ref("users/"+currentUserID+"/type").once("value").then(function(e){"Investor"==e.val()?investorTour():"Entrepreneur"==e.val()?accntntTour():"Accountant"==e.val()&&accntntTour()})}function investorTour(){if(null==$.cookie("visited")){var e=function(e,t,n,a){return-1===t?($.prompt.prevState(),!1):1===t?($.prompt.nextState(),!1):void(2===t&&($.prompt.close(),linkEmUp()))},t=[{title:"Welcome to WatchTower!",html:"We get it! Finance is a complicated beast. But WatchTower helps you tame that beast!<br><br> Our platform allows you to <strong>keep watch</strong> over your Startups (if you're an investor), manage the financial activity of various Companies (if you're a financial professional), or show off your financial health (if you're an entreprenuer).<br><br><strong>Note:</strong> You can restart the tutorial if you got lost or closed out. It's the first thing on the menu button. *wink wink*",buttons:{Next:1},focus:0,submit:e},{title:"An Investor? Fancy!",html:"Keeping up with all your companies is a daunting task. We get it!<br><br> Have your companies register on WatchTower, add their Company Key to your WatchList and keep track of their finances.",buttons:{Prev:-1,Next:1},focus:1,submit:e},{title:"Alright, this sounds confusing...",html:"That's okay! Our platform is designed for ease of use! Just enter data 'line-by-line' from your financial documents! Here's a little walkthrough: <br><br><strong>First:</strong> Add Company via the menu at the top right (three dots). Company key is attached to the Company Description/Notes Card - bottom of page.<br><br><strong>Second:</strong> Select Company which appears under WatchTower logo (on the top left).",buttons:{Prev:-1,Next:1},focus:1,submit:e},{title:"The Special Sauce",html:"WatchTower's <strong>Health Score</strong> is the 'special sauce' that brings it all together - Our proprietary financial index consists of 4 core financial ratios which are boiled down into one easy number.<br><br> Details can be found in the <strong>glossary</strong>.",buttons:{Prev:-1,Next:1},focus:1,submit:e},{title:"Tick Tock",html:"Don't lose track of time! Currently, WatchTower utilizes a hard calendar dating system. Quarters end at midnight. <br><br>We've added a countdown (top left) until the next quarter begins so you dont lose track. Previous Quarter button on the left.",buttons:{Prev:-1,Next:1},focus:1,submit:e},{title:"Y = mx + b",html:"Yeah, rememebr slope intercept formula from high school? Us, too... <br><br>All charts are implemented via the Charts.js open-source library. They're interactive, so don't be shy!<br><br><strong>Note:</strong> Toggle (hide/show) data items by clicking the top rectangle adjacent to the item name. The chart colors are randomly generated on each new selection so click away!",buttons:{Prev:-1,Next:1},focus:1,submit:e},{title:"That's it!",html:"We truly hope you enjoy using our product. If you have questions, please do not hesitate to contact us. The glossary is attached to the bottom of each page in case some of the terms need an explanation.<br><br><strong>Keep Watch</strong>",buttons:{Done:2},focus:0,submit:e}];$.prompt(t)}$.cookie("visited","yes",{expires:1,path:"/"})}function accntntTour(){if(null==$.cookie("visited")){var e=function(e,t,n,a){return-1===t?($.prompt.prevState(),!1):1===t?($.prompt.nextState(),!1):void(2===t&&($.prompt.close(),createBlankCompany()))},t=[{title:"Welcome to WatchTower!",html:"We get it! Finance is a complicated beast. But WatchTower helps you tame that beast!<br><br> Our platform allows you to <strong>keep watch</strong> over your Startups (if you're an investor), manage the financial activity of various Companies (if you're a financial professional), or show off your financial health (if you're an entreprenuer).<br><br><strong>Note:</strong> You can restart the tutorial if you got lost or closed out. It's the first thing on the menu button. *wink wink*",buttons:{Next:1},focus:0,submit:e},{title:"Alright, this sounds confusing...",html:"That's okay! Our platform is designed for ease of use! Just enter data 'line-by-line' from your financial documents! Here's a little walkthrough: <br><br><strong>First:</strong> Create/Add Company via the menu at the top right (three dots). Company key is attached to the Company Description/Notes Card - bottom of page.<br><br><strong>Second:</strong> Select Company which appears under WatchTower logo (on the top left).<br><br><strong>Third (if you're the admin):</strong> Look for the pencil at the top right of each card where financial data is required. And by the way, check out the input card located at the bottom. It's pretty nifty.",buttons:{Prev:-1,Next:1},focus:1,submit:e},{title:"The Special Sauce",html:"WatchTower's <strong>Health Score</strong> is the 'special sauce' that brings it all together - Our proprietary financial index consists of 4 core financial ratios which are boiled down into one easy number.<br><br> Details can be found in the <strong>glossary</strong>.",buttons:{Prev:-1,Next:1},focus:1,submit:e},{title:"Tick Tock",html:"Don't lose track of time! Currently, WatchTower utilizes a hard calendar dating system. Quarters end at midnight. <br><br>We've added a countdown (top left) until the next quarter begins so you dont lose track. Previous Quarter button on the left.",buttons:{Prev:-1,Next:1},focus:1,submit:e},{title:"Y = mx + b",html:"Yeah, rememebr slope intercept formula from high school? Us, too... <br><br>All charts are implemented via the Charts.js open-source library. They're interactive, so don't be shy!<br><br><strong>Note:</strong> Toggle (hide/show) data items by clicking the top rectangle adjacent to the item name. The chart colors are randomly generated on each new selection so click away!",buttons:{Prev:-1,Next:1},focus:1,submit:e},{title:"That's it!",html:"We truly hope you enjoy using our product. If you have questions, please do not hesitate to contact us. The glossary is attached to the bottom of each page in case some of the terms need an explanation.<br><br> Next, you will be asked to register your company with WatchTower.<br><br><strong>Keep Watch</strong>",buttons:{Done:2},focus:0,submit:e}];$.prompt(t)}$.cookie("visited","yes",{expires:1,path:"/"})}function initApp(){firebase.auth().onAuthStateChanged(function(e){e||(window.location="login.html"),currentUserID=firebase.auth().currentUser.uid,whatUserTypeAreYou(),generateCompanyList(),calculateHScomponents(),calculateHealthScore(),setTimeout(function(){logOut()},5e6)})}var companySelectionKey,selectedCompanyName,currentHealthScore,currentYear=moment().format("YYYY"),currentQuarter=moment().format("Q-YYYY"),justTheQ=moment().format("Q"),previousQuarter=moment().subtract(1,"Q").format("Q-YYYY"),currentUserID,currCompCash=0,poolColors=function(e){var t=[];for(i=0;i<e;i++)t.push(dynamicColors());return t},dynamicColors=function(){return"rgba("+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+", 0.55)"};document.addEventListener("DOMContentLoaded",function(e){$("#modeToggleButton").hide(),$("#hlthScoreRatioEditButton2").hide(),$("#ALLcomponentsEditButton").hide(),$("#dywChartEditButton").hide(),$("#aVlChartEditButton").hide(),$("#sectorDataEditButton").hide(),$("#compDesEditButton").hide(),$("#pastHSdataPointButton").hide(),$("#removePastHSdataButton").hide(),$("#deleteCompanyButton").hide(),$("#removeFromWatchListButton").hide(),$("#dywChanEditButton").hide(),$("#sectorDataEditButton").hide(),$("#aVlDisplayEditButton").hide(),$("#fadBalanceEditButton").hide(),$("#fadIncomeEditButton").hide(),$("#fadCashFlowEditButton").hide(),$("#allDataInputsCard").hide(),quarterCountdown(),initApp(),"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("js/sw.js").then(function(e){console.log("ServiceWorker registration successful with scope: ",e.scope)},function(e){console.log("ServiceWorker registration failed: ",e)})}),self.addEventListener("install",function(e){e.waitUntil(caches.open(CACHE_NAME).then(function(e){return console.log("Opened cache"),e.addAll(urlsToCache)}))}),self.addEventListener("fetch",function(e){e.respondWith(caches.match(e.request).then(function(t){if(t)return t;var n=e.request.clone();return fetch(n).then(function(t){if(!t||200!==t.status||"basic"!==t.type)return t;var n=t.clone();return caches.open(CACHE_NAME).then(function(t){t.put(e.request,n)}),t})}))}),self.addEventListener("activate",function(e){var t=["my-site-cache-v1"];e.waitUntil(caches.keys().then(function(e){return Promise.all(e.map(function(e){if(-1===t.indexOf(e))return caches.delete(e)}))}))})});